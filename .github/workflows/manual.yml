# This is a basic workflow that is manually triggered

name: Test Token Access

# Controls when the action will run. Workflow runs when manually triggered using the UI
# or API.
on:
  workflow_dispatch:
    # Inputs the workflow accepts.
    inputs:
      name:
        # Friendly description to be shown in the UI instead of 'name'
        description: 'Person to greet'
        # Default value if no value is explicitly provided
        default: 'World'
        # Input has to be provided for the workflow to run
        required: true
        # The data type of the input
        type: string

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "greet"
  greet:
    # The type of runner that the job will run on
    strategy:
      fail-fast: false
      matrix:
        platform:
          - name: windows_x86_64
            runs-on: windows-2022
          - name: macos_x86-64
            runs-on: macos-13
          - name: linux_x86-64
            runs-on: ubuntu-22.04
        java: [17]
    runs-on: ${{ matrix.platform.runs-on }}

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
    # Runs a single command using the runners shell
    - name: Send greeting
      run: echo "Hello ${{ inputs.name }}"
    - name: Create Artifacts Dir
      run: |
        mkdir -p C:/Users/artifacts && touch C:/Users/artifacts/test_artifact.txt && 
        mkdir -p C:/Users/artifacts2 && touch C:/Users/artifacts2/test_artifact2.txt
    # - name: Create Artifacts Dir
    #   run: |
    #     mkdir -p C:/Users/artifacts && touch C:/Users/artifacts/test_artifact.txt
    - name: Archive Artifact
      uses: actions/upload-artifact@v4
      with:
        name: webrtc_java
        path: |
          C:/Users/artifacts/*.txt
          C:/Users/artifacts2/*.txt
    - name: Create Artifacts Dir
      run: |
        mkdir -p C:/Users/allartifacts
    - name: Download Artifacts
      uses: actions/download-artifact@v4.3.0
      with:
        name: webrtc_java
        path: C:/Users/allartifacts/

    - name: List Artifacts
      run: ls C:/Users/allartifacts

    # - name: Get Token    
    #   run: |
    #     curl --location --request GET "https://gitlab.1c-connect.com" --header "Content-Type: application/json" "PRIVATE-TOKEN: ${{ secrets.GITLAB_TOKEN }}"      
